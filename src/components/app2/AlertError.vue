<template>
  <div class="kuroco-alert kuroco-alert--system-error">
    <svg width="100" height="100" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M29.7917 46.6668C30.2778 47.1529 30.8507 47.396 31.5105 47.396C32.1702 47.396 32.7431 47.1529 33.2292 46.6668L36.1459 43.7502L39.1667 46.771C39.6528 47.2571 40.2257 47.4828 40.8855 47.4481C41.5452 47.4134 42.1181 47.1529 42.6042 46.6668C43.0903 46.1807 43.3334 45.6078 43.3334 44.9481C43.3334 44.2884 43.0903 43.7154 42.6042 43.2293L39.5834 40.3127L42.6042 37.2918C43.0903 36.8057 43.3334 36.2328 43.3334 35.5731C43.3334 34.9134 43.0903 34.3404 42.6042 33.8543C42.1181 33.3682 41.5452 33.1252 40.8855 33.1252C40.2257 33.1252 39.6528 33.3682 39.1667 33.8543L36.1459 36.8752L33.125 33.8543C32.6389 33.3682 32.0834 33.1252 31.4584 33.1252C30.8334 33.1252 30.2778 33.3682 29.7917 33.8543C29.3056 34.3404 29.0625 34.9134 29.0625 35.5731C29.0625 36.2328 29.3056 36.8057 29.7917 37.2918L32.7084 40.3127L29.6875 43.3335C29.2014 43.8196 28.9757 44.3752 29.0105 45.0002C29.0452 45.6252 29.3056 46.1807 29.7917 46.6668V46.6668ZM57.5 46.6668C57.9862 47.1529 58.5591 47.396 59.2188 47.396C59.8785 47.396 60.4514 47.1529 60.9375 46.6668L63.8542 43.7502L66.875 46.771C67.3612 47.2571 67.9341 47.4828 68.5938 47.4481C69.2535 47.4134 69.8264 47.1529 70.3125 46.6668C70.7987 46.1807 71.0417 45.6078 71.0417 44.9481C71.0417 44.2884 70.7987 43.7154 70.3125 43.2293L67.2917 40.3127L70.3125 37.2918C70.7987 36.8057 71.0417 36.2328 71.0417 35.5731C71.0417 34.9134 70.7987 34.3404 70.3125 33.8543C69.8264 33.3682 69.2535 33.1252 68.5938 33.1252C67.9341 33.1252 67.3612 33.3682 66.875 33.8543L63.8542 36.8752L60.8334 33.8543C60.3473 33.3682 59.7917 33.1252 59.1667 33.1252C58.5417 33.1252 57.9862 33.3682 57.5 33.8543C57.0139 34.3404 56.7709 34.9134 56.7709 35.5731C56.7709 36.2328 57.0139 36.8057 57.5 37.2918L60.4167 40.3127L57.3959 43.3335C56.9098 43.8196 56.6841 44.3752 56.7188 45.0002C56.7535 45.6252 57.0139 46.1807 57.5 46.6668V46.6668ZM50 91.6668C44.3056 91.6668 38.9237 90.5731 33.8542 88.3856C28.7848 86.1981 24.3577 83.212 20.573 79.4273C16.7882 75.6425 13.8021 71.2154 11.6146 66.146C9.42712 61.0766 8.33337 55.6599 8.33337 49.896C8.33337 44.2016 9.42712 38.8196 11.6146 33.7502C13.8021 28.6807 16.7882 24.271 20.573 20.521C24.3577 16.771 28.7848 13.8022 33.8542 11.6147C38.9237 9.42725 44.3403 8.3335 50.1042 8.3335C55.7987 8.3335 61.1806 9.42725 66.25 11.6147C71.3195 13.8022 75.7292 16.771 79.4792 20.521C83.2292 24.271 86.198 28.6807 88.3855 33.7502C90.573 38.8196 91.6667 44.2363 91.6667 50.0002C91.6667 55.6946 90.573 61.0766 88.3855 66.146C86.198 71.2154 83.2292 75.6425 79.4792 79.4273C75.7292 83.212 71.3195 86.1981 66.25 88.3856C61.1806 90.5731 55.7639 91.6668 50 91.6668ZM50 85.4168C59.8612 85.4168 68.2292 81.962 75.1042 75.0523C81.9792 68.1425 85.4167 59.7918 85.4167 50.0002C85.4167 40.1391 81.9792 31.771 75.1042 24.896C68.2292 18.021 59.8612 14.5835 50 14.5835C40.2084 14.5835 31.8577 18.021 24.948 24.896C18.0382 31.771 14.5834 40.1391 14.5834 50.0002C14.5834 59.7918 18.0382 68.1425 24.948 75.0523C31.8577 81.962 40.2084 85.4168 50 85.4168ZM32.5 70.3127H67.5C68.4723 70.3127 69.1841 70.0002 69.6355 69.3752C70.0868 68.7502 70.0348 68.021 69.4792 67.1877C67.4653 63.8543 64.7049 61.2502 61.198 59.3752C57.691 57.5002 53.9584 56.5627 50 56.5627C46.0417 56.5627 42.3264 57.5002 38.8542 59.3752C35.382 61.2502 32.6389 63.8543 30.625 67.1877C30.0695 68.021 30 68.7502 30.4167 69.3752C30.8334 70.0002 31.5278 70.3127 32.5 70.3127Z"
      />
    </svg>
    <p class="kuroco-alert__heading">何らかのエラーが発生しました</p>
    <p v-for="err_msg in err_arr">{{ err_msg }}</p>
    <nav class="kuroco-modal__body__section">
      <button type="button" class="kuroco-button--primary kuroco-u-my-lg" @click.prevent="redirect({ target: 'List' })">
        <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M10.5323 7.82468C10.6848 7.9772 10.7645 8.16785 10.7715 8.39663C10.7784 8.62541 10.7056 8.81606 10.5531 8.96859L7.80771 11.6932H17.6661C17.9018 11.6932 18.0994 11.7729 18.2589 11.9323C18.4183 12.0918 18.498 12.2894 18.498 12.5251C18.498 12.7608 18.4183 12.9584 18.2589 13.1178C18.0994 13.2773 17.9018 13.357 17.6661 13.357H7.80771L10.5739 16.1024C10.7264 16.2688 10.7992 16.4629 10.7923 16.6848C10.7853 16.9066 10.7056 17.0938 10.5531 17.2463C10.3867 17.3988 10.1891 17.4751 9.96034 17.4751C9.73155 17.4751 9.5409 17.3988 9.38838 17.2463L5.24952 13.1075C5.16632 13.0243 5.10393 12.9341 5.06233 12.8371C5.02073 12.74 4.99994 12.636 4.99994 12.5251C4.99994 12.4142 5.02073 12.3102 5.06233 12.2131C5.10393 12.1161 5.16632 12.0259 5.24952 11.9427L9.36758 7.82468C9.53397 7.65829 9.72809 7.5751 9.94994 7.5751C10.1718 7.5751 10.3659 7.65829 10.5323 7.82468Z"
            fill="#fff"
          />
        </svg>
        <span>一覧に戻る</span>
      </button>
    </nav>
  </div>
</template>

<script>
export default {
  emits: 'redirect',
  props: {
    err: {
      type: [String, Array],
      default: '',
    },
  },
  computed: {
    err_arr() {
      // Normalize errors as array of strings for all
      if (typeof this.err === 'string' || this.err instanceof String) {
        return [this.err];
      } else {
        // Could be array : use parseErr to make sure each item is a string
        return this.err.map((err) => this.parseErr(err)).filter((err) => err != null && err != '');
      }
    },
  },
  methods: {
    parseErr(err) {
      if (typeof err === 'string' || err instanceof String) {
        return err;
      } else if (typeof err === 'object' && err !== null) {
        // Handling necessary ? For now accept only strings or arrays of string
      }
      return null;
    },
    redirect(params) {
      this.$emit('redirect', params);
    },
  },
};
</script>
